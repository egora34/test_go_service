## запуск тестов

1. Развернуть тестируемый [сервис](https://github.com/derlaft/golang-test-task-2)
1. Установить [pytest](https://docs.pytest.org/en/latest/getting-started.html)
1. При необходимости поменять url в файле `conftest.py`
1. Запустить тесты с помощью `pytest`

Примечание: первые два теста упадут из-за некорректного поведения сервиса


## Реализованные тест-кейсы

1. "солнечного дня" - только проверка, что при корректно переданом json с корректными данными возвращается нужная строка.  
1. "дождливого дня": 
		* доступ к порту без get_config
		* запрос без ключа data
		* запрос без ключа type
		* запрос с пустой строкой по ключу data
		* запрос с пустой строкой по ключу type
		* запрос с нестроковым значением по ключу data
		* запрос с нестроковым значением по ключу type
		* запрос с некорректным json

Примечание: кейсы с пустыми строками закрывают весь пласт кейсов на проверку несуществующих значений в базе

## баги и неточности

1. После корректного запроса в ответе по ключу "port" находится число. В тз в обоих примерах port передаётся строкой 
1. После корректного запроса в ответе передается всегда ключ data. В тз в обоих примерах ответа такого ключа нет
1. Если не передаётся ключ data или type то в базе ищутся пустые значения в замен отсутствующих ключей, и выдаётся ошибка о том что конфигурации или записи с таким значением не существует. Было бы логичнее предупреждать о том что не передаётся один из этих ключей, так как они по сути обязательны для корректного ответа.


## нагрузочное тестирование

В файле `test.jmx` лежит тест план для jmeter
Тест план простейший, чтобы просто показать, что видел в глаза jmeter. Пользовался ещё locust, но jmeter может больше пользователей имитировать на одной и той же машине. 
Вообще проводить нагрузочное тестирование на той же машине на которой развернута сама система не очень полезно (само тестирование ест достаточно ресурсов, ещё и сервис будет под нагрузкой от этого результаты могут быть некорректны; и локальное окружение тем более не такое же как продовое)

Результаты теста нагрузки: на моей машине при 1000 одновременных запросах из тест плана на который должен возвращаться всегда 200 ответ с результатом, иногда возвращались 400 и была ошибка в логах сервиса "pq: sorry, too many clients already" 